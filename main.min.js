function initMap(){var e=document.getElementById("map");map=new google.maps.Map(e,{center:{lat:-0,lng:0},zoom:2}),$("#gpsBtn").tooltip(),geocoder=new google.maps.Geocoder,answer=document.getElementById("answer"),location1Input=document.getElementById("location1");var o=new google.maps.places.Autocomplete(location1Input),n=document.getElementById("location2"),t=new google.maps.places.Autocomplete(n);initialiseMarkers(),configureListeners(o,t)}function midpoint(){void 0===place1||void 0===place2?alertDialog("Please select valid locations.",!0):calculateMidpoint(place1.geometry.location,place2.geometry.location)}function getGPS(){navigator.geolocation?navigator.geolocation.getCurrentPosition(function(e){var o={lat:e.coords.latitude,lng:e.coords.longitude};map.setCenter(o),map.setZoom(6),geocodeLatLng(geocoder,o.lat,o.lng).then(function(e){location1Input.value=e,location1Input.focus()},function(e){console.log(e)})},function(){handleLocationError(!0,map.getCenter())}):handleLocationError(!1,map.getCenter())}function handleLocationError(e,o){console.log("GPS not supported."),alertDialog("GPS is not supported on this device. Please enter locations manually.",!0)}function geocodeLatLng(e,o,n){return new Promise(function(t,a){var r={lat:parseFloat(o),lng:parseFloat(n)};e.geocode({location:r},function(e,o){o===google.maps.GeocoderStatus.OK?e[1]?t(e[1].formatted_address):alertDialog("No results found",!1):t("in the middle of nowhere!")})})}function calculateMidpoint(e,o){var n=google.maps.geometry.spherical.computeDistanceBetween(e,o),t=t="Location 1 is "+n.toFixed(2)+" metres away from Location 2.",a=google.maps.geometry.spherical.interpolate(e,o,.5);geocodeLatLng(geocoder,a.lat(),a.lng()).then(function(e){var o="The midpoint is "+e+" which is "+n.toFixed(2)/2+" metres away.";alertDialog("<p>"+t+"</p><p>"+o+"</p>",!1);var r={lat:a.lat(),lng:a.lng()};markers[2].setPosition(r),markers[2].setVisible(!0),closeInfoWindows(),resizeMap(),infoWindows[2].setContent(e)},function(e){console.log(e)})}function initialiseMarkers(){for(var e=0;3>e;e++){var o=new google.maps.InfoWindow,n=new google.maps.Marker({map:map,anchorPoint:new google.maps.Point(0,-29),animation:google.maps.Animation.DROP,strokeColor:"green"});google.maps.event.addListener(n,"click",function(e,o){return function(){o.open(map,e)}}(n,o)),markers.push(n),infoWindows.push(o)}markers[2].setIcon("images/green-pin.png")}function configureListeners(e,o){e.addListener("place_changed",function(){closeInfoWindows(),markers[0].setVisible(!1),place1=e.getPlace(),place1.geometry.viewport?(map.fitBounds(place1.geometry.viewport),map.setZoom(10)):(map.setCenter(place1.geometry.location),map.setZoom(10)),markers[0].setPosition(place1.geometry.location),markers[0].setVisible(!0);var o="";place1.address_components&&(o=generateAddress(place1.address_components)),infoWindows[0].setContent("<strong>"+place1.name+"</strong><br>"+o)}),o.addListener("place_changed",function(){closeInfoWindows(),markers[1].setVisible(!1),place2=o.getPlace(),place2.geometry.viewport?(map.fitBounds(place2.geometry.viewport),map.setZoom(10)):(map.setCenter(place2.geometry.location),map.setZoom(10)),markers[1].setPosition(place2.geometry.location),markers[1].setVisible(!0);var e="";place2.address_components&&(e=generateAddress(place2.address_components)),infoWindows[1].setContent("<strong>"+place2.name+"</strong><br>"+e)})}function alertDialog(e,o){o===!0?$("#alertDialog").removeClass("alert-info").addClass("alert-danger"):$("#alertDialog").removeClass("alert-danger").addClass("alert-info"),$("#alertDialog").html(e).fadeIn()}function generateAddress(e){var o=[e[0]&&e[0].short_name||"",e[1]&&e[1].short_name||"",e[2]&&e[2].short_name||""].join(" ");return o}function resizeMap(){for(var e=new google.maps.LatLngBounds,o=0;o<markers.length;o++)e.extend(markers[o].getPosition());map.setCenter(e.getCenter()),map.fitBounds(e)}function closeInfoWindows(){for(var e=0;e<infoWindows.length;e++)infoWindows[e].close()}var geocoder,map,location1Input,place1,place2,answer,markers=[],infoWindows=[];!function(e,o,n,t,a,r,s){e.GoogleAnalyticsObject=a,e[a]=e[a]||function(){(e[a].q=e[a].q||[]).push(arguments)},e[a].l=1*new Date,r=o.createElement(n),s=o.getElementsByTagName(n)[0],r.async=1,r.src=t,s.parentNode.insertBefore(r,s)}(window,document,"script","//www.google-analytics.com/analytics.js","ga"),ga("create","UA-73677252-1","auto"),ga("send","pageview");